import base64
import webbrowser
import os
import subprocess

# Base64 encoded string (output from previous step)
html_base64 = 'PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+U3lzdGVtIEluZm88L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgIGJvZHkgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IH0KICAgICAgICAuaW5mbyB7IG1hcmdpbjogMjBweDsgfQogICAgICAgIC5pbmZvIGRpdiB7IG1hcmdpbi1ib3R0b206IDEwcHg7IH0KICAgIDwvc3R5bGU+CiAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgZnVuY3Rpb24gcmVkaXJlY3RUb1BhZ2UoKSB7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJ2h0dHA6Ly93d3cuc2hhZG93ZHJ1bXMuY29tJzsKICAgICAgICB9CgogICAgICAgIGFzeW5jIGZ1bmN0aW9uIGZldGNoU3lzdGVtSW5mbygpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly8xMjcuMC4wLjE6NTAwMC9zeXN0ZW1faW5mbycpOwogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NwdV91c2FnZScpLmlubmVyVGV4dCA9IGRhdGEuY3B1X3VzYWdlOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhbV91c2FnZScpLmlubmVyVGV4dCA9IGRhdGEucmFtX3VzYWdlOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc2tfdG90YWwnKS5pbm5lclRleHQgPSBkYXRhLmRpc2tfdG90YWw7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlza191c2VkJykuaW5uZXJUZXh0ID0gZGF0YS5kaXNrX3VzZWQ7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlza19mcmVlJykuaW5uZXJUZXh0ID0gZGF0YS5kaXNrX2ZyZWU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlza191c2FnZScpLmlubmVyVGV4dCA9IGRhdGEuZGlza191c2FnZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjcHVfdGVtcCcpLmlubmVyVGV4dCA9IGRhdGEuY3B1X3RlbXAgIT09IG51bGwgPyBkYXRhLmNwdV90ZW1wIDogJ04vQSc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpdmF0ZV9pcCcpLmlubmVyVGV4dCA9IGRhdGEucHJpdmF0ZV9pcDsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwdWJsaWNfaXAnKS5pbm5lclRleHQgPSBkYXRhLnB1YmxpY19pcDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGV0IGdwdUluZm8gPSAnJzsKICAgICAgICAgICAgICAgIGRhdGEuZ3B1X2luZm8uZm9yRWFjaChncHUgPT4gewogICAgICAgICAgICAgICAgICAgIGdwdUluZm8gKz0gYE5hbWU6ICR7Z3B1LmdwdV9uYW1lfSwgTG9hZDogJHtncHUuZ3B1X2xvYWQudG9GaXhlZCgyKX0lLCBUZW1wOiAke2dwdS5ncHVfdGVtcGVyYXR1cmV9wrBDPGJyPmA7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncHVfaW5mbycpLmlubmVySFRNTCA9IGdwdUluZm87CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzeXN0ZW0gaW5mbzonLCBlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEZldGNoIHN5c3RlbSBpbmZvIGV2ZXJ5IDUgc2Vjb25kcwogICAgICAgIHNldEludGVydmFsKGZldGNoU3lzdGVtSW5mbywgNTAwMCk7CiAgICAgICAgZmV0Y2hTeXN0ZW1JbmZvKCk7IC8vIGluaXRpYWwgZmV0Y2gKICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPHA+UHJlc3MgT0sgdG8gY29udGludWUgdG8gdGhlIHBhZ2U6PC9wPgogICAgPGJ1dHRvbiBvbmNsaWNrPSJyZWRpcmVjdFRvUGFnZSgpIj5PSzwvYnV0dG9uPgogICAgPGgzPkRldmljZSBJbmZvPC9oMz4KICAgIDxkaXYgY2xhc3M9ImluZm8iPgogICAgICAgIDxkaXY+Q1BVIFVzYWdlOiA8c3BhbiBpZD0iY3B1X3VzYWdlIj48L3NwYW4+JTwvZGl2PgogICAgICAgIDxkaXY+UkFNIFVzYWdlOiA8c3BhbiBpZD0icmFtX3VzYWdlIj48L3NwYW4+JTwvZGl2PgogICAgICAgIDxkaXY+RGlzayBUb3RhbDogPHNwYW4gaWQ9ImRpc2tfdG90YWwiPjwvc3Bhbj4gR0I8L2Rpdj4KICAgICAgICA8ZGl2PkRpc2sgVXNlZDogPHNwYW4gaWQ9ImRpc2tfdXNlZCI+PC9zcGFuPiBHQjwvZGl2PgogICAgICAgIDxkaXY+RGlzayBGcmVlOiA8c3BhbiBpZD0iZGlza19mcmVlIj48L3NwYW4+IEdCPC9kaXY+CiAgICAgICAgPGRpdj5EaXNrIFVzYWdlOiA8c3BhbiBpZD0iZGlza191c2FnZSI+PC9zcGFuPiU8L2Rpdj4KICAgICAgICA8ZGl2PkNQVSBUZW1wZXJhdHVyZTogPHNwYW4gaWQ9ImNwdV90ZW1wIj48L3NwYW4+wrBDPC9kaXY+CiAgICAgICAgPGRpdj5Qcml2YXRlIElQOiA8c3BhbiBpZD0icHJpdmF0ZV9pcCI+PC9zcGFuPjwvZGl2PgogICAgICAgIDxkaXY+UHVibGljIElQOiA8c3BhbiBpZD0icHVibGljX2lwIj48L3NwYW4+PC9kaXY+CiAgICAgICAgPGRpdj5HUFUgSW5mbzogPHNwYW4gaWQ9ImdwdV9pbmZvIj48L3NwYW4+PC9kaXY+CiAgICA8L2Rpdj4KPC9ib2R5Pgo8L2h0bWw+Cg=='
# Decode base64 to hex
html_hex = base64.b64decode(html_base64).hex()

# Decode hex to original HTML content
decoded_html = bytes.fromhex(html_hex).decode('utf-8')

# Define the output file path
output_file_path = 'output.html'

# Save the decoded HTML content to a file
with open(output_file_path, 'w', encoding='utf-8') as file:
    file.write(decoded_html)

# Start the backend server
subprocess.Popen(['python', 'backend.py'], cwd=os.getcwd())

# Open the output file in the default web browser
webbrowser.open(f'file://{os.path.abspath(output_file_path)}')
